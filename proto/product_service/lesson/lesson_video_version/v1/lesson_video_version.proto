syntax = "proto3";

package proto.product_service.lesson.lesson_video_version.v1;

import "product_service/video/v1/video.proto";

import "google/protobuf/timestamp.proto";

option go_package = "github.com/mikhail5545/protos/gen/go/product_service/lesson/lesson_video_version/v1;lesson_video_versionpbv1";

enum LessonVideoVersionStatus{
  LESSON_VIDEO_VERSION_STATUS_UNSPECIFIED = 0;
  LESSON_VIDEO_VERSION_STATUS_ACTIVE = 1;
  LESSON_VIDEO_VERSION_STATUS_DRAFT = 2;
  LESSON_VIDEO_VERSION_STATUS_SUPERSEDED = 3;
  LESSON_VIDEO_VERSION_STATUS_ARCHIVED = 4;
}

message LessonVideoVersion{
  bytes uuid = 1;
  google.protobuf.Timestamp created_at = 2;
  google.protobuf.Timestamp updated_at = 3;
  optional google.protobuf.Timestamp deleted_at = 4;

  bytes lesson_uuid = 5;
  bytes video_uuid = 6;
  video.v1.Video video = 7;

  uint32 version = 8;
  LessonVideoVersionStatus status = 9;
  bool is_latest = 10;
  optional string note = 11;
  optional string archive_reason = 12;

  optional bytes created_by = 13;
  optional bytes published_by = 14;
  optional bytes archived_by = 15;
  optional bytes superseded_by = 16;

  optional string created_by_name = 17;
  optional string published_by_name = 18;
  optional string archived_by_name = 19;
  optional string superseded_by_name = 20;
}

message AssociateRequest{
  bytes owner_uuid = 1;
  bytes media_service_uuid = 2;
  string note = 3;
  bytes admin_uuid = 4;
  string admin_name = 5;
}

message AssociateResponse{}

message PublishRequest{
  bytes version_uuid = 1;
  string behavior = 2;
  string note = 3;
  bytes admin_uuid = 4;
  string admin_name = 5;
}

message PublishResponse {}

message ListRequest{
  repeated bytes uuids = 1;
  repeated bytes lesson_uuids = 2;
  repeated bytes video_uuids = 3;
  repeated bytes media_service_uuids = 4;

  optional bool is_latest = 5;

  optional string order_by = 6;
  optional string order_dir = 7;

  int32 page_size = 8;
  string page_token = 9;
}

message ListResponse{
  repeated LessonVideoVersion lesson_video_versions = 1;
  string next_page_token = 2;
}

message ListDraftsRequest{
  repeated bytes uuids = 1;
  repeated bytes lesson_uuids = 2;
  repeated bytes video_uuids = 3;
  repeated bytes media_service_uuids = 4;

  optional bool is_latest = 5;

  optional string order_by = 6;
  optional string order_dir = 7;

  int32 page_size = 8;
  string page_token = 9;
}

message ListDraftsResponse{
  repeated LessonVideoVersion lesson_video_versions = 1;
  string next_page_token = 2;
}

message ListSupersededRequest{
  repeated bytes uuids = 1;
  repeated bytes lesson_uuids = 2;
  repeated bytes video_uuids = 3;
  repeated bytes media_service_uuids = 4;

  optional bool is_latest = 5;

  optional string order_by = 6;
  optional string order_dir = 7;

  int32 page_size = 8;
  string page_token = 9;
}

message ListSupersededResponse{
  repeated LessonVideoVersion lesson_video_versions = 1;
  string next_page_token = 2;
}

message ListArchivedRequest{
  repeated bytes uuids = 1;
  repeated bytes lesson_uuids = 2;
  repeated bytes video_uuids = 3;
  repeated bytes media_service_uuids = 4;

  optional bool is_latest = 5;

  optional string order_by = 6;
  optional string order_dir = 7;

  int32 page_size = 8;
  string page_token = 9;
}

message ListArchivedResponse{
  repeated LessonVideoVersion lesson_video_versions = 1;
  string next_page_token = 2;
}

message DeleteDraftRequest{
  bytes uuid = 1;
}

message DeleteDraftResponse {}

message PingRequest {}

message PingResponse {
  int64 timestamp = 1;
}

service LessonVideoVersionService{
  rpc Ping(PingRequest) returns (PingResponse);
  rpc List(ListRequest) returns (ListResponse);
  rpc ListDrafts(ListDraftsRequest) returns (ListDraftsResponse);
  rpc ListSuperseded(ListSupersededRequest) returns (ListSupersededResponse);
  rpc ListArchived(ListArchivedRequest) returns (ListArchivedResponse);
  rpc Associate(AssociateRequest) returns (AssociateResponse);
  rpc Publish(PublishRequest) returns (PublishResponse);
  rpc DeleteDraft(DeleteDraftRequest) returns (DeleteDraftResponse);
}